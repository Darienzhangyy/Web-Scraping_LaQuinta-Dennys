---
title: "visualize"
output: html_document
---



```{r,results='asis',warning=FALSE}
suppressPackageStartupMessages(library(googleVis))
op=options(gvis.plot.tag='chart')
library(stringr)

load("./data/LaQuinta.RData")
load("./data/dennys.Rdata")
load("./data/Lq.RData")
load("./data/stateDistance.RData")
download.file("http://www.downloadexcelfiles.com/sites/default/files/docs/list-states-us-36j.csv",destfile = "./data/Statepop.csv")
Statepop=read.csv("/Users/YY/Documents/DUKE/Courses/2015Fall/STA523/HWs/HW2/Darien/data/Statepop.csv",skip=1,header = TRUE)
Statepop=Statepop[-1,]
Statepop=head(Statepop,50)
row.names(Statepop) <- c(1:50)
Statepop=Statepop[,-1]
Statepop$Population.est.=gsub(",", "", Statepop$Population.est., fixed = TRUE)

#Number of La Quinta in every state
dataLQ <- data.frame(LaQuinta)
Statecount=as.data.frame(lapply(dataLQ, table)$State)
names(Statecount)=c("Abbr.","LaQuinta")
Statecount = merge(Statecount, Statepop, by = 'Abbr.')
Statecount$LQpcapita=Statecount$LaQuinta/as.numeric(Statecount$Population.est.)

#Total number within states
Lq1 = gvisGeoChart(Statecount, locationvar='State', colorvar='LaQuinta',
                   options=list(region='US',displayMode="regions",
                   resolution="provinces",colorAxis="{colors:['yellow'
                   ,'red']}",backgroundColor="cornflowerblue",
                   width=700, height=430))
plot(Lq1)

#Per capita number within states
Lq2 = gvisGeoChart(Statecount, locationvar='State', colorvar='LQpcapita',
                  options=list(region='US',displayMode="regions",
                  resolution="provinces",colorAxis="{colors: ['yellow'
                  ,'red']}", backgroundColor="cornflowerblue",width=700,
                  height=430))
plot(Lq2)

########################################################

#Number of Denny's in every state
dataDen = data.frame(dennys_info)
#get the last split in address, unlist it to get a vector
DenState = unlist(lapply(str_split(dataDen$address, ", "), function(x) x[length(x)]))
#split the blanks
DenState = unlist(lapply(str_split(DenState, " "), function(x) x[1]))
#get the state count of Denny's
DenState = as.data.frame(lapply(as.data.frame(DenState), table))
names(DenState)=c("Abbr.","Dennys")
DenState = merge(DenState, Statepop, by = 'Abbr.')
DenState$Dennyspcapita=DenState$Dennys/as.numeric(DenState$Population.est.)
#latlong<-paste(dataDen$latitude, dataDen$longitude, sep=":")

#Total number within states
Den1 = gvisGeoChart(DenState, locationvar='State', colorvar='Dennys',
                     options=list(region="US",displayMode="regions",
                     resolution="provinces",colorAxis="{colors:['yellow'
                     ,'red']}",backgroundColor="cornflowerblue",width=700,
                     height=430))
plot(Den1)

#Per capita number within states
Den2 = gvisGeoChart(DenState, locationvar='State', colorvar='Dennyspcapita',
                    options=list(region="US",displayMode="regions",
                    resolution="provinces",colorAxis="{colors:['yellow'
                    ,'red']}", backgroundColor="cornflowerblue",width=700,
                    height=430))
plot(Den2)


library(rworldmap)
newmap <- getMap(resolution = "low")
#Positions of LaQuinta
plot(newmap, xlim = c(-125, -60), ylim = c(25, 45), asp = 1.5)
points(dennys_info$longitude, dennys_info$latitude, col = "red", cex = .6)
#Positions of Denny's
plot(newmap, xlim = c(-125, -60), ylim = c(25, 45), asp = 1.5)
points(hotel_info$longitude, hotel_info$latitude, col = "blue", cex = .6)
#Position of LaQuinta & Denny's
plot(newmap, xlim = c(-125, -60), ylim = c(25, 45), asp = 1.5)
points(dennys_info$longitude, dennys_info$latitude, col = "red", cex = .6)
points(hotel_info$longitude, hotel_info$latitude, col = "blue", cex = .6)

#Mean distance of LaQuinta & Denny's within every state
Dis = gvisGeoChart(stateDistance, locationvar='cluster', colorvar='Median',
                    options=list(region="US",displayMode="regions",
                    resolution="provinces",colorAxis="{colors:['yellow'
                    ,'red']}", backgroundColor="cornflowerblue",width=700,
                    height=430))
plot(Dis)
```


